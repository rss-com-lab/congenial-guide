{"version":3,"sources":["components/dragAndDrop/dragAndDrop.js","components/dragAndDrop/index.js","components/chart/Chart.js","components/app/App.js","components/app/index.js","index.js"],"names":["SheetJSApp","state","data","cols","handleFile","file","reader","FileReader","rABS","readAsBinaryString","onload","e","bstr","target","result","wb","XLSX","read","type","wsname","SheetNames","ws","Sheets","utils","sheet_to_json","header","_this","props","stateUpdateFunc","setState","make_cols","readAsArrayBuffer","exportFile","aoa_to_sheet","book_new","book_append_sheet","writeFile","_this$state","this","react_default","a","createElement","dragAndDrop_DragDropFile","className","dragAndDrop_DataInput","disabled","length","onClick","dragAndDrop_OutTable","Component","DragDropFile","suppress","evt","stopPropagation","preventDefault","onDrop","files","dataTransfer","_this2","onDragEnter","onDragOver","children","DataInput","handleChange","_this3","htmlFor","id","accept","SheetJSFT","onChange","OutTable","_this$props","map","c","key","name","r","i","x","join","refstr","o","C","decode_range","encode_col","uv","pv","amt","SimpleLineChart","es6","width","height","margin","top","right","left","bottom","strokeDasharray","dataKey","stroke","activeDot","data1","StackedAreaChart","stackId","fill","data3","SimpleBarChart","data2","style","lineHeight","SimpleRadialBarChart","cx","cy","innerRadius","outerRadius","barSize","minAngle","label","position","background","clockWise","iconSize","layout","verticalAlign","wrapperStyle","App","workerWorkbook","illnessWorkbook","updatePeopleState","sheet","updateIllState","processingWorkerbook","fieldMapping","sheetet","workers","row","currentRow","v","tabNumber","startDate","w","getWorker","console","log","processingIllnessWorkbook","records","begin","end","getRecord","processingData","results","record","worker","find","illBegin","illEnd","filter","dragAndDrop","App_ProcessingButton","Chart_SimpleLineChart","Chart_StackedAreaChart","Chart_SimpleRadialBarChart","Chart_SimpleBarChart","ProcessingButton","_ref","root","document","getElementById","ReactDOM","render","app"],"mappings":"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","file":"static/js/main.9e3bfa72.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport XLSX from \"xlsx\";\r\n\r\n\r\nexport default class SheetJSApp extends Component {\r\n  \r\n  state = {\r\n    data: [] /* Array of Arrays e.g. [[\"a\",\"b\"],[1,2]] */,\r\n    cols: [] /* Array of column objects e.g. { name: \"C\", K: 2 } */\r\n  };\r\n\r\n  handleFile = (file /*:File*/) => {\r\n    /* Boilerplate to set up FileReader */\r\n    const reader = new FileReader();\r\n    const rABS = !!reader.readAsBinaryString;\r\n    reader.onload = e => {\r\n      /* Parse data */\r\n      const bstr = e.target.result;\r\n      const wb = XLSX.read(bstr, { type: rABS ? \"binary\" : \"array\" });\r\n      // console.log(wb);\r\n      /* Get first worksheet */\r\n      const wsname = wb.SheetNames[0];\r\n      // console.log(wsname);\r\n      const ws = wb.Sheets[wsname];\r\n      // console.log(ws);\r\n      /* Convert array of arrays */\r\n      const data = XLSX.utils.sheet_to_json(ws, { header: 1 });\r\n      /* Update state */\r\n      this.props.stateUpdateFunc(wb);\r\n      this.setState({ data: data, cols: make_cols(ws[\"!ref\"]) });\r\n      // console.log(this.state.data);\r\n      \r\n    };\r\n    if (rABS) reader.readAsBinaryString(file);\r\n    else reader.readAsArrayBuffer(file);\r\n  }\r\n  exportFile = () => {\r\n    /* convert state to workbook */\r\n    const ws = XLSX.utils.aoa_to_sheet(this.state.data);\r\n    const wb = XLSX.utils.book_new();\r\n    XLSX.utils.book_append_sheet(wb, ws, \"SheetJS\");\r\n    /* generate XLSX file and send to client */\r\n    XLSX.writeFile(wb, \"sheetjs.xlsx\");\r\n  }\r\n  render() {\r\n\r\n    const {data, cols} = this.state;\r\n\r\n    return (\r\n      <DragDropFile handleFile={this.handleFile}>\r\n        <div className=\"row\">\r\n          <div className=\"col-xs-12\">\r\n            <DataInput handleFile={this.handleFile} />\r\n          </div>\r\n        </div>\r\n        <div className=\"row\">\r\n          <div className=\"col-xs-12\">\r\n            <button\r\n              disabled={!this.state.data.length}\r\n              className=\"btn btn-success\"\r\n              onClick={this.exportFile}\r\n            >\r\n              Export\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"row\">\r\n          <div className=\"col-xs-12\">\r\n            <OutTable data={data} cols={cols} />\r\n          </div>\r\n        </div>\r\n      </DragDropFile>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n\r\n/* -------------------------------------------------------------------------- */\r\n\r\n/*\r\n  Simple HTML5 file drag-and-drop wrapper\r\n  usage: <DragDropFile handleFile={handleFile}>...</DragDropFile>\r\n    handleFile(file:File):void;\r\n*/\r\nclass DragDropFile extends Component {\r\n \r\n  suppress = (evt) => {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n  }\r\n  onDrop = (evt) => {\r\n    evt.stopPropagation();\r\n    evt.preventDefault();\r\n    const files = evt.dataTransfer.files;\r\n    if (files && files[0]) this.props.handleFile(files[0]);\r\n  }\r\n  render() {\r\n    return (\r\n      <div\r\n        onDrop={this.onDrop}\r\n        onDragEnter={this.suppress}\r\n        onDragOver={this.suppress}\r\n      >\r\n        {this.props.children}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n/*\r\n  Simple HTML5 file input wrapper\r\n  usage: <DataInput handleFile={callback} />\r\n    handleFile(file:File):void;\r\n*/\r\nclass DataInput extends Component {\r\n  \r\n  handleChange = (e) => {\r\n    const files = e.target.files;\r\n    if (files && files[0]) this.props.handleFile(files[0]);\r\n  }\r\n  render() {\r\n    return (\r\n      <form className=\"form-inline\">\r\n        <div className=\"form-group\">\r\n          <label htmlFor=\"file\">Spreadsheet</label>\r\n          <input\r\n            type=\"file\"\r\n            className=\"form-control\"\r\n            id=\"file\"\r\n            accept={SheetJSFT}\r\n            onChange={this.handleChange}\r\n          />\r\n        </div>\r\n      </form>\r\n    );\r\n  }\r\n}\r\n\r\n/*\r\n  Simple HTML Table\r\n  usage: <OutTable data={data} cols={cols} />\r\n    data:Array<Array<any> >;\r\n    cols:Array<{name:string, key:number|string}>;\r\n*/\r\nclass OutTable extends Component {\r\n  \r\n  render() {\r\n\r\n    const {data, cols} = this.props; \r\n\r\n    return (\r\n      <div className=\"table-responsive\">\r\n        <table className=\"table table-striped\">\r\n          <thead>\r\n            <tr>\r\n              {cols.map(c => (\r\n                <th key={c.key}>{c.name}</th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            {data.map((r, i) => (\r\n              <tr key={i}>\r\n                {cols.map(c => (\r\n                  <td key={c.key}>{r[c.key]}</td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n/* list of supported file types */\r\nconst SheetJSFT = [\r\n  \"xlsx\",\r\n  \"xlsb\",\r\n  \"xlsm\",\r\n  \"xls\",\r\n  \"xml\",\r\n  \"csv\",\r\n  \"txt\",\r\n  \"ods\",\r\n  \"fods\",\r\n  \"uos\",\r\n  \"sylk\",\r\n  \"dif\",\r\n  \"dbf\",\r\n  \"prn\",\r\n  \"qpw\",\r\n  \"123\",\r\n  \"wb*\",\r\n  \"wq*\",\r\n  \"html\",\r\n  \"htm\"\r\n]\r\n  .map(function (x) {\r\n    return \".\" + x;\r\n  })\r\n  .join(\",\");\r\n\r\n/* generate an array of column objects */\r\nconst make_cols = refstr => {\r\n  let o = [],\r\n    C = XLSX.utils.decode_range(refstr).e.c + 1;\r\n  for (var i = 0; i < C; ++i) o[i] = { name: XLSX.utils.encode_col(i), key: i };\r\n  return o;\r\n};\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// export default class DragAndDrop extends Component {\r\n//   state = {\r\n//     files: []\r\n//   };\r\n\r\n//   onDrop = (files) => {\r\n//     // console.log(acceptedFiles);\r\n//     // console.log(rejectedFiles);\r\n//     // console.log(files[0].path);\r\n    \r\n//     // console.log(this.state.files);\r\n//     // this.setState((state) =>{\r\n//     //   state.files.push(files[0]);\r\n//     // });\r\n//     // var name = files[0].name;\r\n\r\n    \r\n//   };\r\n\r\n//   render() {\r\n//     const baseStyle = {\r\n//       width: 200,\r\n//       height: 200,\r\n//       borderWidth: 2,\r\n//       borderColor: \"#666\",\r\n//       borderStyle: \"dashed\",\r\n//       borderRadius: 5\r\n//     };\r\n//     const activeStyle = {\r\n//       borderStyle: \"solid\",\r\n//       borderColor: \"#6c6\",\r\n//       backgroundColor: \"#eee\"\r\n//     };\r\n//     const rejectStyle = {\r\n//       borderStyle: \"solid\",\r\n//       borderColor: \"#c66\",\r\n//       backgroundColor: \"#eee\"\r\n//     };\r\n//     return (\r\n//       <div>\r\n//         <h2>Drop And Crop</h2>\r\n//         <Dropzone onDrop={this.onDrop}>\r\n//           {({\r\n//             getRootProps,\r\n//             getInputProps,\r\n//             isDragActive,\r\n//             isDragAccept,\r\n//             isDragReject,\r\n//             acceptedFiles,\r\n//             rejectedFiles\r\n//           }) => {\r\n//             let styles = { ...baseStyle };\r\n//             styles = isDragActive ? { ...styles, ...activeStyle } : styles;\r\n//             styles = isDragReject ? { ...styles, ...rejectStyle } : styles;\r\n\r\n//             return (\r\n//               <div {...getRootProps()} style={styles}>\r\n//                 <input {...getInputProps()} />\r\n//                 <div>{isDragAccept ? \"Drop\" : \"Drag\"} files here...</div>\r\n//                 {isDragReject && <div>Unsupported file type...</div>}\r\n//               </div>\r\n//             );\r\n//           }}\r\n//         </Dropzone>\r\n//       </div>\r\n//     );\r\n//   }\r\n// }\r\n","import SheetJSApp from \"./dragAndDrop\";\r\n\r\nexport default SheetJSApp;\r\n","import React, { Component } from 'react';\r\nimport {\r\n    LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend,\r\n    AreaChart, Area, RadialBarChart, RadialBar, BarChart, Bar\r\n} from 'recharts';\r\n\r\nconst data = [\r\n    {\r\n        name: 'Page A', uv: 4000, pv: 2400, amt: 2400,\r\n    },\r\n    {\r\n        name: 'Page B', uv: 3000, pv: 1398, amt: 2210,\r\n    },\r\n    {\r\n        name: 'Page C', uv: 2000, pv: 9800, amt: 2290,\r\n    },\r\n    {\r\n        name: 'Page D', uv: 2780, pv: 3908, amt: 2000,\r\n    },\r\n    {\r\n        name: 'Page E', uv: 1890, pv: 4800, amt: 2181,\r\n    },\r\n    {\r\n        name: 'Page F', uv: 2390, pv: 3800, amt: 2500,\r\n    },\r\n    {\r\n        name: 'Page G', uv: 3490, pv: 4300, amt: 2100,\r\n    },\r\n];\r\n\r\nclass SimpleLineChart extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <LineChart\r\n                width={500}\r\n                height={300}\r\n                data={data}\r\n                margin={{\r\n                    top: 5, right: 30, left: 20, bottom: 5,\r\n                }}\r\n            >\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\" />\r\n                <YAxis />\r\n                <Tooltip />\r\n                <Legend />\r\n                <Line type=\"monotone\" dataKey=\"pv\" stroke=\"#8884d8\" activeDot={{ r: 8 }} />\r\n                <Line type=\"monotone\" dataKey=\"uv\" stroke=\"#82ca9d\" />\r\n            </LineChart>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nconst data1 = [\r\n    {\r\n        name: 'Page A', uv: 4000, pv: 2400, amt: 2400,\r\n    },\r\n    {\r\n        name: 'Page B', uv: 3000, pv: 1398, amt: 2210,\r\n    },\r\n    {\r\n        name: 'Page C', uv: 2000, pv: 9800, amt: 2290,\r\n    },\r\n    {\r\n        name: 'Page D', uv: 2780, pv: 3908, amt: 2000,\r\n    },\r\n    {\r\n        name: 'Page E', uv: 1890, pv: 4800, amt: 2181,\r\n    },\r\n    {\r\n        name: 'Page F', uv: 2390, pv: 3800, amt: 2500,\r\n    },\r\n    {\r\n        name: 'Page G', uv: 3490, pv: 4300, amt: 2100,\r\n    },\r\n];\r\n\r\nclass StackedAreaChart extends Component {\r\n    \r\n    render() {\r\n        return (\r\n            <AreaChart\r\n                width={500}\r\n                height={400}\r\n                data={data1}\r\n                margin={{\r\n                    top: 10, right: 30, left: 0, bottom: 0,\r\n                }}\r\n            >\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\" />\r\n                <YAxis />\r\n                <Tooltip />\r\n                <Area type=\"monotone\" dataKey=\"uv\" stackId=\"1\" stroke=\"#8884d8\" fill=\"#8884d8\" />\r\n                <Area type=\"monotone\" dataKey=\"pv\" stackId=\"1\" stroke=\"#82ca9d\" fill=\"#82ca9d\" />\r\n                <Area type=\"monotone\" dataKey=\"amt\" stackId=\"1\" stroke=\"#ffc658\" fill=\"#ffc658\" />\r\n            </AreaChart>\r\n        );\r\n    }\r\n}\r\n\r\n\r\n\r\nconst data3 = [\r\n    {\r\n        name: 'Page A', uv: 4000, pv: 2400, amt: 2400,\r\n    },\r\n    {\r\n        name: 'Page B', uv: 3000, pv: 1398, amt: 2210,\r\n    },\r\n    {\r\n        name: 'Page C', uv: 2000, pv: 9800, amt: 2290,\r\n    },\r\n    {\r\n        name: 'Page D', uv: 2780, pv: 3908, amt: 2000,\r\n    },\r\n    {\r\n        name: 'Page E', uv: 1890, pv: 4800, amt: 2181,\r\n    },\r\n    {\r\n        name: 'Page F', uv: 2390, pv: 3800, amt: 2500,\r\n    },\r\n    {\r\n        name: 'Page G', uv: 3490, pv: 4300, amt: 2100,\r\n    },\r\n];\r\n\r\nclass SimpleBarChart extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <BarChart\r\n                width={500}\r\n                height={300}\r\n                data={data3}\r\n                margin={{\r\n                    top: 5, right: 30, left: 20, bottom: 5,\r\n                }}\r\n            >\r\n                <CartesianGrid strokeDasharray=\"3 3\" />\r\n                <XAxis dataKey=\"name\" />\r\n                <YAxis />\r\n                <Tooltip />\r\n                <Legend />\r\n                <Bar dataKey=\"pv\" fill=\"#8884d8\" />\r\n                <Bar dataKey=\"uv\" fill=\"#82ca9d\" />\r\n            </BarChart>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nconst data2 = [\r\n    {\r\n        name: '18-24', uv: 31.47, pv: 2400, fill: '#8884d8',\r\n    },\r\n    {\r\n        name: '25-29', uv: 26.69, pv: 4567, fill: '#83a6ed',\r\n    },\r\n    {\r\n        name: '30-34', uv: 15.69, pv: 1398, fill: '#8dd1e1',\r\n    },\r\n    {\r\n        name: '35-39', uv: 8.22, pv: 9800, fill: '#82ca9d',\r\n    },\r\n    {\r\n        name: '40-49', uv: 8.63, pv: 3908, fill: '#a4de6c',\r\n    },\r\n    {\r\n        name: '50+', uv: 2.63, pv: 4800, fill: '#d0ed57',\r\n    },\r\n    {\r\n        name: 'unknow', uv: 6.67, pv: 4800, fill: '#ffc658',\r\n    },\r\n];\r\n\r\nconst style = {\r\n    top: 0,\r\n    left: 350,\r\n    lineHeight: '24px',\r\n};\r\n\r\n\r\nclass SimpleRadialBarChart extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <RadialBarChart width={500} height={300} cx={150} cy={150} innerRadius={20} outerRadius={140} barSize={10} data={data2}>\r\n                <RadialBar minAngle={15} label={{ position: 'insideStart', fill: '#fff' }} background clockWise dataKey=\"uv\" />\r\n                <Legend iconSize={10} width={120} height={140} layout=\"vertical\" verticalAlign=\"middle\" wrapperStyle={style} />\r\n            </RadialBarChart>\r\n        );\r\n    }\r\n}\r\n\r\n\r\nexport { SimpleLineChart, StackedAreaChart, SimpleRadialBarChart, SimpleBarChart };\r\n","import React, { Component } from \"react\";\nimport SheetJSApp from \"../dragAndDrop\";\nimport {\n  SimpleLineChart,\n  StackedAreaChart,\n  SimpleRadialBarChart,\n  SimpleBarChart\n} from \"../chart\";\n\nexport default class App extends Component {\n  state = {\n    workerWorkbook: null,\n    illnessWorkbook: null\n  };\n\n  updatePeopleState = sheet => {\n    this.setState({ workerWorkbook: sheet });\n    // console.log(this.state);\n    \n  };\n\n  updateIllState = sheet => {\n    this.setState({ illnessWorkbook: sheet });\n    // console.log(this.state);\n    \n  };\n\n  processingWorkerbook = () => {\n    const { workerWorkbook } = this.state;\n\n    const fieldMapping = {\n      name: \"B\",\n      tabNumber: \"C\",\n      startDate: \"G\"\n    };\n\n    const getWorker = (sheet, currentRow) => {\n      const worker = {\n        name: sheet[fieldMapping.name + currentRow].v,\n        tabNumber: sheet[fieldMapping.tabNumber + currentRow].v,\n        startDate: sheet[fieldMapping.startDate + currentRow].w\n      };\n\n      return worker;\n    };\n\n    const getWorkers = sheet => {\n      const rows = [2, 3, 4, 5];\n\n      return rows.map(row => {\n        return getWorker(sheet, row);\n      });\n    };\n\n    // const worker = {\n    //   name: \"Иванова Ольга Пеонидовна\",\n    //   tabNumber: \"1519\",\n    //   startDate: \"10/11/1993\"\n    // };\n    const sheetet = workerWorkbook.Sheets[workerWorkbook.SheetNames[0]];\n    // console.log('values', workerListWorkboox.Sheets['Sheet1']['B2']['v'])\n    const workers = getWorkers(sheetet);\n    console.log(\"workers\", workers);\n\n    return workers;\n  };\n\n  processingIllnessWorkbook = () => {\n    const { illnessWorkbook } = this.state;\n    const getRecord = (sheet, currentRow) => {\n      const fieldMapping = {\n        name: \"B\",\n        tabNumber: \"D\",\n        begin: \"K\",\n        end: \"L\"\n      };\n\n      const record = {\n        name: sheet[fieldMapping.name + currentRow].v,\n        tabNumber: sheet[fieldMapping.tabNumber + currentRow].v,\n        begin: sheet[fieldMapping.begin + currentRow].w,\n        end: sheet[fieldMapping.end + currentRow].w\n      };\n\n      return record;\n    };\n\n    const getRecords = sheet => {\n      const rows = [2, 3, 4, 5, 6, 7];\n\n      return rows.map(row => {\n        return getRecord(sheet, row);\n      });\n    };\n    const records = getRecords(\n      illnessWorkbook.Sheets[illnessWorkbook.SheetNames[0]]\n    );\n    console.log(\"records\", records);\n    return records;\n  };\n\n  processingData = () => {\n    console.log(\"processing\");\n    const workers = this.processingWorkerbook();\n    const records = this.processingIllnessWorkbook();\n    const results = records\n      .map(record => {\n        // console.log(\"record\", record);\n\n        const worker = workers.find(w => w.tabNumber === record.tabNumber);\n\n        if (!worker) return null;\n\n        return {\n          name: worker.name,\n          startDate: worker.startDate,\n          illBegin: record.begin,\n          illEnd: record.end\n        };\n      })\n      .filter(r => r);\n\n    console.log(\"results\", results);\n  };\n\n  render() {\n    return (\n      <div className=\"app\">\n        <SheetJSApp stateUpdateFunc={this.updatePeopleState} />\n        <SheetJSApp stateUpdateFunc={this.updateIllState} />\n        <ProcessingButton onClick={this.processingData} />\n        <div>SimpleLineChart</div>\n        <SimpleLineChart />\n        <div>StackedAreaChart</div>\n        <StackedAreaChart />\n        <div>SimpleRadialBarChart</div>\n        <SimpleRadialBarChart />\n        <div>SimpleBarChart</div>\n        <SimpleBarChart />\n      </div>\n    );\n  }\n}\n\nconst ProcessingButton = ({ onClick }) => {\n  return <button onClick={onClick}>Get Processing Data</button>;\n};\n","import App from \"./App\";\r\n\r\nexport default App;\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/app\";\n\nconst root = document.getElementById(\"root\");\n\nReactDOM.render(<App />, root);\n"],"sourceRoot":""}